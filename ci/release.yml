platform: linux

image_resource:
  type: docker-image
  source:
    repository: buildo/scala-sbt-alpine
    tag: 8u201_2.12.8_1.2.8

inputs:
  - name: toctoc

params:
  GITHUB_DEPLOY_KEY:
  PGP_PASSPHRASE:
  PGP_SECRET:
  SONATYPE_USERNAME:
  SONATYPE_PASSWORD:

run:
  dir: toctoc
  path: sh
  args:
    - -ce
    - |
      export GIT_USER=nemobot@buildo.io
      apk --no-progress add --update gnupg git yarn autoconf automake g++ libc6-compat bash libjpeg-turbo-dev libpng-dev make nasm
      sbt "; ci-release; docs/docusaurusPublishGhpages"
